{"ast":null,"code":"var _jsxFileName = \"/Users/arminforoughi/Documents/storycraft/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport './App.css';\nimport StoryForm from './components/StoryForm';\nimport Storybook from './components/Storybook';\nimport { parseStoryResponse } from './utils/storyParser';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [story, setStory] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [streamingData, setStreamingData] = useState([]);\n  const [isStreaming, setIsStreaming] = useState(false);\n  const generateStory = async formData => {\n    setLoading(true);\n    setError(null);\n    setStreamingData([]);\n    setIsStreaming(true);\n    try {\n      // Use empty string for history if it's a new story\n      const history = formData.history || \"\";\n      const response = await fetch('/api/released-app/03ebb9ea-1fda-493c-86da-597e2801635e/run', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ww-5916h52zF1qi3SxMASUJ1HScxn1LibbpYmewHyfrJBs56tixAjGvR1'\n        },\n        body: JSON.stringify({\n          inputs: {\n            childname: formData.childName,\n            interests: formData.interests,\n            readinglevel: formData.readingLevel,\n            history: history\n          },\n          version: \"^3.0\"\n        })\n      });\n      if (!response.ok) {\n        throw new Error('Failed to generate story');\n      }\n\n      // For streaming, just display the raw text first\n      const text = await response.text();\n\n      // Try to extract and display any images from the response\n      const imageUrlRegex = /\"image_url\":\"([^\"]+)\"/g;\n      let match;\n      const imageUrls = [];\n      while ((match = imageUrlRegex.exec(text)) !== null) {\n        imageUrls.push(match[1]);\n      }\n\n      // Extract text content - now including choice_text\n      const textContentRegex = /\"(introduction|adventure|resolution|choice)_text\":\"([^\"]+)\"/g;\n      const textContents = [];\n      while ((match = textContentRegex.exec(text)) !== null) {\n        textContents.push({\n          type: match[1],\n          text: match[2]\n        });\n      }\n\n      // Extract options\n      const optionsRegex = /\"options\":\\s*\\[(.*?)\\]/s;\n      const optionsMatch = text.match(optionsRegex);\n      let options = [];\n      if (optionsMatch && optionsMatch[1]) {\n        try {\n          // Try to parse the options array\n          const optionsText = `[${optionsMatch[1]}]`;\n          options = JSON.parse(optionsText.replace(/\\\\\"/g, '\"'));\n        } catch (e) {\n          console.error('Failed to parse options:', e);\n        }\n      }\n\n      // Create a simple story object from the extracted data\n      if (imageUrls.length > 0 && textContents.length > 0) {\n        // Ensure we have 4 pages maximum\n        const pages = [];\n\n        // Map the text content types to their respective pages\n        const contentMap = textContents.reduce((map, content) => {\n          map[content.type] = content.text;\n          return map;\n        }, {});\n\n        // Create pages in the correct order\n        if (contentMap.introduction) {\n          pages.push({\n            text: contentMap.introduction,\n            image: imageUrls.length > 0 ? imageUrls[0] : null\n          });\n        }\n        if (contentMap.adventure) {\n          pages.push({\n            text: contentMap.adventure,\n            image: imageUrls.length > 1 ? imageUrls[1] : null\n          });\n        }\n        if (contentMap.resolution) {\n          pages.push({\n            text: contentMap.resolution,\n            image: imageUrls.length > 2 ? imageUrls[2] : null\n          });\n        }\n        if (contentMap.choice) {\n          pages.push({\n            text: contentMap.choice,\n            image: imageUrls.length > 3 ? imageUrls[3] : null,\n            options: options\n          });\n        }\n        setStory({\n          output: {\n            pages,\n            rawResponse: text // Store the raw response for potential continuation\n          }\n        });\n      } else {\n        // Try to parse as JSON as a fallback\n        try {\n          const data = JSON.parse(text);\n          const parsedStory = parseStoryResponse(data);\n          setStory(parsedStory);\n        } catch (e) {\n          console.error('Failed to parse response:', e);\n          setError('Failed to parse the story response');\n        }\n      }\n\n      // Display the raw response for debugging\n      setStreamingData([{\n        type: 'raw',\n        value: text\n      }]);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n      setIsStreaming(false);\n    }\n  };\n\n  // Function to parse streaming response data\n  const parseStreamingResponse = data => {\n    if (data.type === 'outputs') {\n      const storyData = data.values;\n\n      // Extract text and images\n      const pages = [];\n      if (storyData.story_generation) {\n        // Add introduction page\n        if (storyData.story_generation.introduction_text) {\n          var _storyData$Intro_imag, _storyData$Intro_imag2;\n          pages.push({\n            text: storyData.story_generation.introduction_text,\n            image: ((_storyData$Intro_imag = storyData.Intro_image) === null || _storyData$Intro_imag === void 0 ? void 0 : (_storyData$Intro_imag2 = _storyData$Intro_imag.output) === null || _storyData$Intro_imag2 === void 0 ? void 0 : _storyData$Intro_imag2.image_url) || null\n          });\n        }\n\n        // Add adventure page\n        if (storyData.story_generation.adventure_text) {\n          var _storyData$adventure_, _storyData$adventure_2;\n          pages.push({\n            text: storyData.story_generation.adventure_text,\n            image: ((_storyData$adventure_ = storyData.adventure_image) === null || _storyData$adventure_ === void 0 ? void 0 : (_storyData$adventure_2 = _storyData$adventure_.output) === null || _storyData$adventure_2 === void 0 ? void 0 : _storyData$adventure_2.image_url) || null\n          });\n        }\n\n        // Add resolution page\n        if (storyData.story_generation.resolution_text) {\n          var _storyData$Resolution, _storyData$Resolution2;\n          pages.push({\n            text: storyData.story_generation.resolution_text,\n            image: ((_storyData$Resolution = storyData.Resolution_image) === null || _storyData$Resolution === void 0 ? void 0 : (_storyData$Resolution2 = _storyData$Resolution.output) === null || _storyData$Resolution2 === void 0 ? void 0 : _storyData$Resolution2.image_url) || null\n          });\n        }\n      }\n      return {\n        output: {\n          pages\n        }\n      };\n    }\n    return null;\n  };\n  const parseStoryResponse = data => {\n    // Check if we have the expected data structure\n    if (!data || !data.outputs) {\n      console.error('Unexpected response format:', data);\n      return null;\n    }\n    try {\n      // Extract the story generation data\n      const storyData = data.outputs.story_generation || {};\n\n      // Create exactly 3 pages for introduction, adventure, and resolution\n      const pages = [];\n\n      // Add introduction page\n      if (storyData.introduction_text) {\n        var _data$outputs$Intro_i, _data$outputs$Intro_i2;\n        pages.push({\n          text: storyData.introduction_text,\n          image: ((_data$outputs$Intro_i = data.outputs.Intro_image) === null || _data$outputs$Intro_i === void 0 ? void 0 : (_data$outputs$Intro_i2 = _data$outputs$Intro_i.output) === null || _data$outputs$Intro_i2 === void 0 ? void 0 : _data$outputs$Intro_i2.image_url) || null\n        });\n      }\n\n      // Add adventure page\n      if (storyData.adventure_text) {\n        var _data$outputs$adventu, _data$outputs$adventu2;\n        pages.push({\n          text: storyData.adventure_text,\n          image: ((_data$outputs$adventu = data.outputs.adventure_image) === null || _data$outputs$adventu === void 0 ? void 0 : (_data$outputs$adventu2 = _data$outputs$adventu.output) === null || _data$outputs$adventu2 === void 0 ? void 0 : _data$outputs$adventu2.image_url) || null\n        });\n      }\n\n      // Add resolution page\n      if (storyData.resolution_text) {\n        var _data$outputs$Resolut, _data$outputs$Resolut2;\n        pages.push({\n          text: storyData.resolution_text,\n          image: ((_data$outputs$Resolut = data.outputs.Resolution_image) === null || _data$outputs$Resolut === void 0 ? void 0 : (_data$outputs$Resolut2 = _data$outputs$Resolut.output) === null || _data$outputs$Resolut2 === void 0 ? void 0 : _data$outputs$Resolut2.image_url) || null\n        });\n      }\n      return {\n        output: {\n          pages\n        }\n      };\n    } catch (error) {\n      console.error('Error parsing story response:', error);\n      return null;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"App-header-minimal\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"logo-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fa-solid fa-book-open\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"logo-text\",\n          children: \"StoryCraft\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      children: [!story && !isStreaming && /*#__PURE__*/_jsxDEV(StoryForm, {\n        onSubmit: generateStory\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 36\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading\",\n        children: \"Generating your storybook... Please wait!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 21\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error\",\n        children: [\"Error: \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 19\n      }, this), isStreaming && streamingData.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"streaming-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Generating your story...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"streaming-content\",\n          children: streamingData.map((chunk, index) => {\n            // Display text chunks\n            if (chunk.type === 'chunk' && chunk.value.type === 'chunk') {\n              return /*#__PURE__*/_jsxDEV(\"span\", {\n                children: chunk.value.value\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 26\n              }, this);\n            }\n\n            // Display images as they come in\n            if (chunk.type === 'chunk' && chunk.value.type === 'tool' && chunk.value.output && chunk.value.output.type === 'image') {\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"streaming-image\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: chunk.value.output.image_url,\n                  alt: \"Story illustration\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 274,\n                  columnNumber: 23\n                }, this)\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 21\n              }, this);\n            }\n            return null;\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }, this), story && !loading && /*#__PURE__*/_jsxDEV(Storybook, {\n        story: story,\n        onNewStory: formData => {\n          if (formData && Object.keys(formData).length > 0) {\n            // Continue the story with the provided form data\n            generateStory(formData);\n          } else {\n            // Start a new story\n            setStory(null);\n            setStreamingData([]);\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 31\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Powered by Wordware AI\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"Tj8W/aTIxT+fKcyQc6fOkFxA8AM=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","StoryForm","Storybook","parseStoryResponse","jsxDEV","_jsxDEV","App","_s","story","setStory","loading","setLoading","error","setError","streamingData","setStreamingData","isStreaming","setIsStreaming","generateStory","formData","history","response","fetch","method","headers","body","JSON","stringify","inputs","childname","childName","interests","readinglevel","readingLevel","version","ok","Error","text","imageUrlRegex","match","imageUrls","exec","push","textContentRegex","textContents","type","optionsRegex","optionsMatch","options","optionsText","parse","replace","e","console","length","pages","contentMap","reduce","map","content","introduction","image","adventure","resolution","choice","output","rawResponse","data","parsedStory","value","err","message","parseStreamingResponse","storyData","values","story_generation","introduction_text","_storyData$Intro_imag","_storyData$Intro_imag2","Intro_image","image_url","adventure_text","_storyData$adventure_","_storyData$adventure_2","adventure_image","resolution_text","_storyData$Resolution","_storyData$Resolution2","Resolution_image","outputs","_data$outputs$Intro_i","_data$outputs$Intro_i2","_data$outputs$adventu","_data$outputs$adventu2","_data$outputs$Resolut","_data$outputs$Resolut2","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","chunk","index","src","alt","onNewStory","Object","keys","_c","$RefreshReg$"],"sources":["/Users/arminforoughi/Documents/storycraft/src/App.js"],"sourcesContent":["import React, { useState } from 'react';\nimport './App.css';\nimport StoryForm from './components/StoryForm';\nimport Storybook from './components/Storybook';\nimport { parseStoryResponse } from './utils/storyParser';\n\nfunction App() {\n  const [story, setStory] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [streamingData, setStreamingData] = useState([]);\n  const [isStreaming, setIsStreaming] = useState(false);\n\n  const generateStory = async (formData) => {\n    setLoading(true);\n    setError(null);\n    setStreamingData([]);\n    setIsStreaming(true);\n    \n    try {\n      // Use empty string for history if it's a new story\n      const history = formData.history || \"\";\n      \n      const response = await fetch('/api/released-app/03ebb9ea-1fda-493c-86da-597e2801635e/run', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ww-5916h52zF1qi3SxMASUJ1HScxn1LibbpYmewHyfrJBs56tixAjGvR1'\n        },\n        body: JSON.stringify({\n          inputs: {\n            childname: formData.childName,\n            interests: formData.interests,\n            readinglevel: formData.readingLevel,\n            history: history\n          },\n          version: \"^3.0\"\n        })\n      });\n      \n      if (!response.ok) {\n        throw new Error('Failed to generate story');\n      }\n      \n      // For streaming, just display the raw text first\n      const text = await response.text();\n      \n      // Try to extract and display any images from the response\n      const imageUrlRegex = /\"image_url\":\"([^\"]+)\"/g;\n      let match;\n      const imageUrls = [];\n      \n      while ((match = imageUrlRegex.exec(text)) !== null) {\n        imageUrls.push(match[1]);\n      }\n      \n      // Extract text content - now including choice_text\n      const textContentRegex = /\"(introduction|adventure|resolution|choice)_text\":\"([^\"]+)\"/g;\n      const textContents = [];\n      \n      while ((match = textContentRegex.exec(text)) !== null) {\n        textContents.push({\n          type: match[1],\n          text: match[2]\n        });\n      }\n      \n      // Extract options\n      const optionsRegex = /\"options\":\\s*\\[(.*?)\\]/s;\n      const optionsMatch = text.match(optionsRegex);\n      let options = [];\n      \n      if (optionsMatch && optionsMatch[1]) {\n        try {\n          // Try to parse the options array\n          const optionsText = `[${optionsMatch[1]}]`;\n          options = JSON.parse(optionsText.replace(/\\\\\"/g, '\"'));\n        } catch (e) {\n          console.error('Failed to parse options:', e);\n        }\n      }\n      \n      // Create a simple story object from the extracted data\n      if (imageUrls.length > 0 && textContents.length > 0) {\n        // Ensure we have 4 pages maximum\n        const pages = [];\n        \n        // Map the text content types to their respective pages\n        const contentMap = textContents.reduce((map, content) => {\n          map[content.type] = content.text;\n          return map;\n        }, {});\n        \n        // Create pages in the correct order\n        if (contentMap.introduction) {\n          pages.push({\n            text: contentMap.introduction,\n            image: imageUrls.length > 0 ? imageUrls[0] : null\n          });\n        }\n        \n        if (contentMap.adventure) {\n          pages.push({\n            text: contentMap.adventure,\n            image: imageUrls.length > 1 ? imageUrls[1] : null\n          });\n        }\n        \n        if (contentMap.resolution) {\n          pages.push({\n            text: contentMap.resolution,\n            image: imageUrls.length > 2 ? imageUrls[2] : null\n          });\n        }\n        \n        if (contentMap.choice) {\n          pages.push({\n            text: contentMap.choice,\n            image: imageUrls.length > 3 ? imageUrls[3] : null,\n            options: options\n          });\n        }\n        \n        setStory({\n          output: { \n            pages,\n            rawResponse: text // Store the raw response for potential continuation\n          }\n        });\n      } else {\n        // Try to parse as JSON as a fallback\n        try {\n          const data = JSON.parse(text);\n          const parsedStory = parseStoryResponse(data);\n          setStory(parsedStory);\n        } catch (e) {\n          console.error('Failed to parse response:', e);\n          setError('Failed to parse the story response');\n        }\n      }\n      \n      // Display the raw response for debugging\n      setStreamingData([{ type: 'raw', value: text }]);\n      \n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n      setIsStreaming(false);\n    }\n  };\n\n  // Function to parse streaming response data\n  const parseStreamingResponse = (data) => {\n    if (data.type === 'outputs') {\n      const storyData = data.values;\n      \n      // Extract text and images\n      const pages = [];\n      \n      if (storyData.story_generation) {\n        // Add introduction page\n        if (storyData.story_generation.introduction_text) {\n          pages.push({\n            text: storyData.story_generation.introduction_text,\n            image: storyData.Intro_image?.output?.image_url || null\n          });\n        }\n        \n        // Add adventure page\n        if (storyData.story_generation.adventure_text) {\n          pages.push({\n            text: storyData.story_generation.adventure_text,\n            image: storyData.adventure_image?.output?.image_url || null\n          });\n        }\n        \n        // Add resolution page\n        if (storyData.story_generation.resolution_text) {\n          pages.push({\n            text: storyData.story_generation.resolution_text,\n            image: storyData.Resolution_image?.output?.image_url || null\n          });\n        }\n      }\n      \n      return {\n        output: {\n          pages\n        }\n      };\n    }\n    \n    return null;\n  };\n\n  const parseStoryResponse = (data) => {\n    // Check if we have the expected data structure\n    if (!data || !data.outputs) {\n      console.error('Unexpected response format:', data);\n      return null;\n    }\n    \n    try {\n      // Extract the story generation data\n      const storyData = data.outputs.story_generation || {};\n      \n      // Create exactly 3 pages for introduction, adventure, and resolution\n      const pages = [];\n      \n      // Add introduction page\n      if (storyData.introduction_text) {\n        pages.push({\n          text: storyData.introduction_text,\n          image: data.outputs.Intro_image?.output?.image_url || null\n        });\n      }\n      \n      // Add adventure page\n      if (storyData.adventure_text) {\n        pages.push({\n          text: storyData.adventure_text,\n          image: data.outputs.adventure_image?.output?.image_url || null\n        });\n      }\n      \n      // Add resolution page\n      if (storyData.resolution_text) {\n        pages.push({\n          text: storyData.resolution_text,\n          image: data.outputs.Resolution_image?.output?.image_url || null\n        });\n      }\n      \n      return {\n        output: {\n          pages\n        }\n      };\n    } catch (error) {\n      console.error('Error parsing story response:', error);\n      return null;\n    }\n  };\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header-minimal\">\n        <div className=\"logo-container\">\n          <i className=\"fa-solid fa-book-open\"></i>\n          <span className=\"logo-text\">StoryCraft</span>\n        </div>\n      </header>\n      <main>\n        {!story && !isStreaming && <StoryForm onSubmit={generateStory} />}\n        {loading && <div className=\"loading\">Generating your storybook... Please wait!</div>}\n        {error && <div className=\"error\">Error: {error}</div>}\n        \n        {isStreaming && streamingData.length > 0 && (\n          <div className=\"streaming-container\">\n            <h2>Generating your story...</h2>\n            <div className=\"streaming-content\">\n              {streamingData.map((chunk, index) => {\n                // Display text chunks\n                if (chunk.type === 'chunk' && chunk.value.type === 'chunk') {\n                  return <span key={index}>{chunk.value.value}</span>;\n                }\n                \n                // Display images as they come in\n                if (chunk.type === 'chunk' && chunk.value.type === 'tool' && \n                    chunk.value.output && chunk.value.output.type === 'image') {\n                  return (\n                    <div key={index} className=\"streaming-image\">\n                      <img src={chunk.value.output.image_url} alt=\"Story illustration\" />\n                    </div>\n                  );\n                }\n                \n                return null;\n              })}\n            </div>\n          </div>\n        )}\n        \n        {story && !loading && <Storybook \n          story={story} \n          onNewStory={(formData) => {\n            if (formData && Object.keys(formData).length > 0) {\n              // Continue the story with the provided form data\n              generateStory(formData);\n            } else {\n              // Start a new story\n              setStory(null);\n              setStreamingData([]);\n            }\n          }} \n        />}\n      </main>\n      <footer>\n        <p>Powered by Wordware AI</p>\n      </footer>\n    </div>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}